"0","library(glmnet)"
"0",""
"0","#Logistic Regression"
"0","library(dplyr)"
"0","womensrole$y<-as.factor(WR2$y)"
"0","womensrole$sex<-NULL"
"0","womensrole$athome<-NULL"
"0","womensrole$agree_c<-NULL"
"0","womensrole$athome<-WR2$athome"
"0","womensrole$education_c<-NULL"
"0","womensrole$agree<-as.numeric(as.character(womensrole$agree))"
"0","yit<-lm(agree~disagree+education+y, data=womensrole)"
"0","summary(yit)"
"1","
Call:
"
"1",""
"1","lm(formula = agree ~ disagree + education + y, data = womensrole)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-35.919 "
"1"," -8.759 "
"1"," -0.714 "
"1","  7.490 "
"1"," 67.525 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","  17.2921"
"1","     6.2695"
"1","   2.758"
"1","  0.00889"
"1"," ** "
"1","
disagree   "
"1","   0.4479"
"1","     0.0413"
"1","  10.846"
"1"," 3.41e-13"
"1"," ***"
"1","
education  "
"1","  -1.2428"
"1","     0.4904"
"1","  -2.535"
"1","  0.01550"
"1"," *  "
"1","
y1         "
"1","  -0.6383"
"1","     5.7406"
"1","  -0.111"
"1","  0.91205"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","18.57"
"1"," "
"1","on"
"1"," "
"1","38"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.7569"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.7377"
"1"," "
"1","
F-statistic:"
"1"," "
"1","39.43"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","38"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","9.416e-12"
"1","
"
"1","
"
"0","#LASSO on Data"
"0","y<-as.matrix(womensrole$agree)"
"0","model.matrix(yit)"
"1","  "
"1"," (Intercept)"
"1"," disagree"
"1"," education"
"1"," y1"
"1","
1 "
"1","           1"
"1","        2"
"1","         0"
"1","  1"
"1","
2 "
"1","           1"
"1","        0"
"1","         1"
"1","  1"
"1","
3 "
"1","           1"
"1","        0"
"1","         2"
"1","  1"
"1","
4 "
"1","           1"
"1","        3"
"1","         3"
"1","  1"
"1","
5 "
"1","           1"
"1","        5"
"1","         4"
"1","  1"
"1","
6 "
"1","           1"
"1","        7"
"1","         5"
"1","  1"
"1","
7 "
"1","           1"
"1","        9"
"1","         6"
"1","  1"
"1","
8 "
"1","           1"
"1","       15"
"1","         7"
"1","  1"
"1","
9 "
"1","           1"
"1","       49"
"1","         8"
"1","  1"
"1","
10"
"1","           1"
"1","       29"
"1","         9"
"1","  1"
"1","
11"
"1","           1"
"1","       45"
"1","        10"
"1","  1"
"1","
12"
"1","           1"
"1","       59"
"1","        11"
"1","  1"
"1","
13"
"1","           1"
"1","      245"
"1","        12"
"1","  1"
"1","
14"
"1","           1"
"1","       70"
"1","        13"
"1","  1"
"1","
15"
"1","           1"
"1","       79"
"1","        14"
"1","  1"
"1","
16"
"1","           1"
"1","       23"
"1","        15"
"1","  1"
"1","
17"
"1","           1"
"1","      110"
"1","        16"
"1","  1"
"1","
18"
"1","           1"
"1","       29"
"1","        17"
"1","  1"
"1","
19"
"1","           1"
"1","       28"
"1","        18"
"1","  1"
"1","
20"
"1","           1"
"1","       13"
"1","        19"
"1","  1"
"1","
21"
"1","           1"
"1","       20"
"1","        20"
"1","  1"
"1","
22"
"1","           1"
"1","        2"
"1","         0"
"1","  0"
"1","
23"
"1","           1"
"1","        0"
"1","         1"
"1","  0"
"1","
24"
"1","           1"
"1","        0"
"1","         2"
"1","  0"
"1","
25"
"1","           1"
"1","        1"
"1","         3"
"1","  0"
"1","
26"
"1","           1"
"1","        0"
"1","         4"
"1","  0"
"1","
27"
"1","           1"
"1","        7"
"1","         5"
"1","  0"
"1","
28"
"1","           1"
"1","        5"
"1","         6"
"1","  0"
"1","
29"
"1","           1"
"1","       16"
"1","         7"
"1","  0"
"1","
30"
"1","           1"
"1","       36"
"1","         8"
"1","  0"
"1","
31"
"1","           1"
"1","       35"
"1","         9"
"1","  0"
"1","
32"
"1","           1"
"1","       67"
"1","        10"
"1","  0"
"1","
33"
"1","           1"
"1","       62"
"1","        11"
"1","  0"
"1","
34"
"1","           1"
"1","      403"
"1","        12"
"1","  0"
"1","
35"
"1","           1"
"1","       92"
"1","        13"
"1","  0"
"1","
36"
"1","           1"
"1","       81"
"1","        14"
"1","  0"
"1","
37"
"1","           1"
"1","       34"
"1","        15"
"1","  0"
"1","
38"
"1","           1"
"1","      115"
"1","        16"
"1","  0"
"1","
39"
"1","           1"
"1","       28"
"1","        17"
"1","  0"
"1","
40"
"1","           1"
"1","       21"
"1","        18"
"1","  0"
"1","
41"
"1","           1"
"1","        2"
"1","        19"
"1","  0"
"1","
42"
"1","           1"
"1","        4"
"1","        20"
"1","  0"
"1","
"
"1","attr(,""assign"")"
"1","
"
"1","[1]"
"1"," 0"
"1"," 1"
"1"," 2"
"1"," 3"
"1","
"
"1","attr(,""contrasts"")"
"1","
"
"1","attr(,""contrasts"")$y
"
"1","[1]"
"1"," ""contr.treatment"""
"1","
"
"1","
"
"0","x<-model.matrix(yit)[,-1]%>%scale%>%as.matrix"
"0","cv<-cv.glmnet(x,y)"
"0","lasso<-glmnet(x,y,lambda=cv$lambda.1se)"
"0","coef(lasso)"
"1","4 x 1 sparse Matrix of class ""dgCMatrix""
"
"1","           "
"1","        s0"
"1","
(Intercept)"
"1"," 24.285714"
"1","
disagree   "
"1"," 26.777891"
"1","
education  "
"1"," -1.733015"
"1","
y1         "
"1","  .       "
"1","
"
"0","#CV"
"0","set.seed(1234)"
"0","k=10"
"0","data1<-womensrole[sample(nrow(womensrole)),]"
"0","folds<-cut(seq(1:nrow(womensrole)),breaks=k,labels=F)"
"0","diags<-NULL"
"0","for(i in 1:k){"
"0"," train<-data1[folds!=i,]"
"0"," test<-data1[folds==i,]"
"0"," truth<-test$agree"
"0"," kit<-lm(agree~disagree+education,data=train)"
"0"," probs<-predict(kit,newdata = test,type=""response"")"
"0"," preds<-ifelse(probs>.5,1,0)"
"0"," #diags<-rbind(diags,class_diag(probs,truth))"
"0","}"
"0","#Residual Standard Error/RMSE Calculation"
"0","library(caret)"
"0","sigma(kit)"
"1","[1]"
"1"," 18.26381"
"1","
"
"0","summary(kit)"
"1","
Call:
"
"1",""
"1","lm(formula = agree ~ disagree + education, data = train)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-38.505 "
"1"," -9.065 "
"1"," -1.603 "
"1","  5.678 "
"1"," 66.524 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 17.09437"
"1","    5.78893"
"1","   2.953"
"1","  0.00567"
"1"," ** "
"1","
disagree   "
"1","  0.45690"
"1","    0.04101"
"1","  11.143"
"1"," 6.81e-13"
"1"," ***"
"1","
education  "
"1"," -1.13335"
"1","    0.51371"
"1","  -2.206"
"1","  0.03423"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","18.26"
"1"," "
"1","on"
"1"," "
"1","34"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.7853"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.7726"
"1"," "
"1","
F-statistic:"
"1"," "
"1","62.16"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","34"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","4.394e-12"
"1","
"
"1","
"
